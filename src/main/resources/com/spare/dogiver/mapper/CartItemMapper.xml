<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="CartItemMapper">

  <resultMap id="Goods" type="com.spare.dogiver.domain.Goods">
    <id property="goodsId" column="goods_id"/>
    <result property="goodsName" column="goods_name"/>
    <result property="goodsPrice" column="goods_price"/>
    <result property="goodsThumbnail" column="goods_thumbnail"/>
  </resultMap>
  
  <resultMap id="CartItem" type="com.spare.dogiver.domain.CartItem">
    <id property="id" column="id" />
    <result property="cartId" column="cart_id"/>
    <result property="cartCnt" column="cart_cnt"/>
    <association property="goods" resultMap="Goods"/>    
  </resultMap>
  
  
  <select id="findAllByCartIdDesc" parameterType="Long" resultMap="CartItem">
    SELECT /*+INDEX_DESC(cart pk_cart_item)*/
           c_i.id as id
         , c_i.cart_cnt as cart_cnt
         , g.goods_thumbnail as goods_thumbnail
         , g.goods_id as goods_id
         , g.goods_name as goods_name
         , g.goods_price as goods_price
      FROM cart_item c_i
           INNER JOIN goods g on c_i.goods_id = g.goods_id
     WHERE c_i.cart_id = #{cartId}
  </select>
  
</mapper>